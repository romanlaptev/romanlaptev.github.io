<!DOCTYPE html>
<html lang="ru">
<head>
	<title>test</title>
	<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
	
	<meta charset="utf-8"/>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!--
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Expires" content="-1">	
-->
	<meta name="referrer" content="no-referrer" />

	
	<link type="text/css" rel="stylesheet" href="../../css/bootstrap337.min.css"/>
<!--
	<script src="../../js/jquery.min.js"></script>
	<script src="../../test_code/js/lib/shared_functions.js"></script>
-->
	<script src="js/test.js"></script>

<script>
//var vars={
	//"dataUrl":"https://api.rasp.yandex.net/v3.0/search/?from=851508&to=851635&apikey=b07a64bc-f237-4e79-9efb-b951ec68eaf7&date=2019-04-26&transport_types=suburban&system=esr&show_systems=esr"
//};

/*
	$.ajax({
		type: "GET",
		url: webApp.vars["DB"]["dataUrl"],
		dataType: "text",
		
		beforeSend: function(XMLHttpRequest){
console.log("ajax beforeSend, ", arguments);
		},				
		
		complete: function(xhr, state){
console.log("ajax load complete, ", arguments);
		},
		
		success: function( data ){
console.log( data );
		},
		
		error: function( data, status, errorThrown ){
console.log( "error", arguments );
		}
	})
	.done(function () {
console.log("$.ajax, Done...");
	})
	.fail(function (xhr, textStatus) {
console.log("$.ajax, Fail...", arguments);
console.log("textStatus:" + textStatus);
	});
*/	

/*
var xhr = new XMLHttpRequest();
xhr.open("GET", vars["dataUrl"], true);
//xhr.setRequestHeader("authorization", "Token xxxxxx");
//xhr.setRequestHeader("Version", "1");
xhr.setRequestHeader("origin", "http://i5");
//xhr.setRequestHeader("Access-Control-Allow-Credentials", "true");
xhr.onload = function() {
  alert( this.responseText );
}
xhr.onerror = function() {
  alert( 'error, status: ' + this.status );
}
xhr.send();
*/

/*
	var script = document.createElement('script');
	script.src = "js/test.js";
//console.log(script);
	//webApp.vars["log"].appendChild(script);
	document.getElementsByTagName('head')[0].appendChild(script);

	script.onload = function() {
alert( "onload " + this.src);
	  }
	script.onerror = function() {
alert( "onerror " + this.src );
	};
*/

/*
			$.ajax({
				type: "GET", 
				url: "js/test.js",
				dataType:"jsonp",
				jsonpCallback: 'my_func',
				//async: false,
				//contentType: "application/json",
				//jsonp: 'callback',
				//crossDomain: true,
				success: function ( data ){
console.log(data);
					//form_content ( data );
				},
					error:function( data, status, errorThrown ){
console.log( "error function, status: " + status );
console.log( "errorThrown: " + errorThrown );
				}
			});	
*/

window.onload = function(){
	var btn_clear_log = document.querySelector("#btn-clear-log");
	//var btn_clear_log = document.getElementById("clear-log");
	btn_clear_log.onclick = function(){
		log.innerHTML = "";
	};//end event

	var btn_load = document.querySelector("#btn-load");
	btn_load.onclick = function(event){
		event = event || window.event;
		var target = event.target || event.srcElement;
//console.log(target);
		loadFrame();
	};//end event

};//end window.load

</script>

<style>
input.invalid{
	background-color:orange;
}

.log-panel {
    margin-bottom: 0;
    margin-top: 5px;
background-color: #b0c4de;
/*
border: 1px solid #ccc;
*/
}
.log-panel .panel-body{
    padding: 5px;
}

.log-panel span a{
text-decoration:none;
outline: none;
}
/*
#log {
    height: 200px;
    overflow-y: scroll;
}*/
#log .alert {
margin-bottom: 0;
padding: 10px;
}

#log p{
margin: 0;
}

</style>
</head>

<body>
<div class="container">
	<div class="page-header">
		<h3>test Yandex APi, CORS</h3>
	</div>
	<div class="log-panel panel">
		<div class="panel-body">
			<span class="pull-right">
				<a id="btn-clear-log" href="#" title="Clear log" class="btn btn-sm btn-default">x</a>
			</span>
			<div id="log" class="panel-body"></div>
		</div>
	</div>

	<div class="panel panel-primary">
		<div class="panel-heading">
			<h4>load data to IFRAME</h4>
		</div>
		<div class="panel-body">
			<input id="iframe-src" class="form-control" type="text" autocomplete="off"
value="https://api.rasp.yandex.net/v3.0/search/?from=851508&to=851635&apikey=b07a64bc-f237-4e79-9efb-b951ec68eaf7&date=2019-04-26&transport_types=suburban&system=esr&show_systems=esr"/>
			<a href="#" class="btn btn-info" id="btn-load">load iframe</a>
<pre>
http://i5/sites/romanlaptev.github.io/projects/schedule/data/2019-04-26.json
https://api.rasp.yandex.net/v3.0/search/?from=851508&to=851635&apikey=b07a64bc-f237-4e79-9efb-b951ec68eaf7&date=2019-04-26&transport_types=suburban&system=esr&show_systems=esr
file:///mnt/terra/clouds/cloud_mail/music/
http://vbox5
</pre>

	<iframe name="test_frame" width="100%" height="40%" src="" onload="getFrameInfo(this)"></iframe>

<!--
<img id="test" src="https://api.rasp.yandex.net/v3.0/search/?from=851508&to=851635&apikey=b07a64bc-f237-4e79-9efb-b951ec68eaf7&date=2019-04-26&transport_types=suburban&system=esr&show_systems=esr"/>
<script>
var test = document.querySelector("#test");
for( var key in test){
console.log(key, test[key]);
}
</script>
-->

		</div>
	</div>	
<pre>
http://javascript.ru/ajax/cross-domain-scripting
http://javascript.ru/ajax/cross-origin-2
Обмен данными для документов с разных доменов

http://slyweb.ru/jquery/cross-domain-ajax/
Кросс-доменный ajax

https://learn.javascript.ru/xhr-crossdomain
XMLHttpRequest: кросс-доменные запросы

https://learn.javascript.ru/ajax-jsonp
Протокол JSONP

https://toster.ru/q/167147
CORS. Отправка запроса с https. Почему не работает?

==========================
Disable same origin policy in Chrome
 run browser - 
 +chromium-browser --disable-web-security
chromium --disable-web-security --user-data-dir=/mnt/d2/temp/0

ERROR:chrome_content_browser_client.cc(2479)] Web security may only be disabled if '--user-data-dir' is also specified.

-------------------

Disable firefox same origin policy
 about:config -> security.fileuri.strict_origin_policy -> false
----------------------

Where to disable cross-network protection in Opera?
opera:config#Network|AllowCrossNetworkNavigation is the right preference.
--------------------


Enabling Cross-Domain AJAX in Firefox
Close Firefox
Edit the file prefs.js in your Firefox user profile folder
Add the following line anywhere in the file:
user_pref("capability.policy.default.XMLHttpRequest.open",
          "allAccess");
!!!!!!!!!!Versions of Firefox prior to Firefox 3 allowed you to set the preference capability.policy..XMLHttpRequest.open to allAccess to give specific sites cross-site access. This is no longer supported.
------------------------------

</pre>
</div><!-- end container -->

</body>
</html>